<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<html class='no-js'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>Unitwise: Ruby Unit Measurement Math and Conversion | Josh W Lewis</title>
<meta content='Unitwise is a RubyGem for unit measurement math and conversion, based on The Unified Code for Units of Measure. | Josh W Lewis: Software Engineer' name='description'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script src="../../javascripts/application/head-cfe85c0f.js" type="text/javascript"></script>
<link href="../../stylesheets/essays-40d41161.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
<!--[if lt IE 7]> <p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p> <![endif]-->
<div id='fixed_banner'>
<a href='/'>
<canvas class='shape-grid'></canvas>
</a>
</div>
<div id='page'>
<div class='container'>
<section class='content'><div class='essay'>
<div class='row header'>
<div class='span8 offset2'>
<h1><a href="/essays/unitwise-ruby-unit-measurement">Unitwise: Ruby Unit Measurement Math and Conversion</a></h1>
<h3>
By
<a rel="author" href="/">Josh</a>
</h3>
<h4>August 13, 2013</h4>
</div>
</div>
<div class='row content'>
<div class='span10 offset1'>
<p>So, way back in Mechanical Engineering school, I learned that a very effective way to check my answers was to make sure the units worked out. For an example, consider a basic physics problem:</p>

<blockquote>
<p>The average mass of an adult American male is 86 kilograms. Determine weight of an average man on the moon where the gravitational field is one-sixth that of the Earth (9.8 m/s<sup>2</sup>).</p>
</blockquote>

<p>If you paid attention in physics, you would work it out like this:</p>
<pre class="highlight ruby">  <span class="n">mass</span> <span class="o">=</span> <span class="mi">86</span> <span class="c1"># 86 kg</span>
  <span class="n">acceleration</span> <span class="o">=</span> <span class="mi">9</span><span class="o">.</span><span class="mi">8</span> <span class="o">/</span> <span class="mi">6</span> <span class="c1"># 1.633334 m/s2</span>
  <span class="n">force</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">acceleration</span> 
  <span class="c1"># =&gt; 140.4666666666667</span>
</pre>
<p>Ok, so 140 &ndash; but 140 what? Since we effectively performed &#39;kg * m/s<sup>2</sup>&#39; it&#39;s plain to see that our unit is &#39;kg&sdot;m/s<sup>2</sup>&#39;. Ok, great, so our unit result is in the form of a mass times an acceleration, just as we would expect to see when calculating a force. When you are using a pen and paper, this is a great way to make sure your result is what you expect (your force is a measurement force, your energy is a unit of energy).</p>

<p>But using straight up Numerics for calculation through Ruby means that we lose track of units. As the calculation gets more complicated, manual unit checking becomes monotonous and error-prone. On <a href="https://www.emergentcoils.com/">emergentcoils.com</a> I&#39;ve had to do a fair amount of these types of calculations (namely heat transfer capacities), and I was getting tired of trying to remember what unit a Numeric value was in.</p>

<p>So, like any good Rubyist, I searched for a RubyGem that could track units as I performed math on them. There are a couple already out there (most notably <a href="https://github.com/olbrich/ruby-units">ruby-units</a>), and they certainly work for many (or probably most) situations. However, they either didn&#39;t have a few of the units I needed or they only did conversion (not Math). </p>

<p>During my search, I ended up stumbling across <a href="http://www.unitsofmeasure.org/">The Unified Code for Units of Measurement (UCUM)</a> &ndash; which had all the units I needed ready to go in XML format. From that <a href="https://github.com/joshwlewis/unitwise">Unitwise</a> was born.</p>

<p>Now, it&#39;s really easy to track units for our example problem:</p>
<pre class="highlight ruby"><span class="n">mass</span> <span class="o">=</span> <span class="mi">86</span><span class="nf">.kg</span>
<span class="c1"># =&gt; &lt;Unitwise::Measurement 86 kg&gt;</span>
<span class="n">acceleration</span> <span class="o">=</span> <span class="mi">9</span><span class="o">.</span><span class="mi">8</span><span class="nf">.convert</span><span class="p">(</span><span class="s1">'m/s2'</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>
<span class="c1"># =&gt; &lt;Unitwise::Measurement 1.6333333333333335 m/s2&gt;</span>
<span class="n">force</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">acceleration</span>
<span class="c1"># =&gt; &lt;Unitwise::Measurement 140.4666666666667 kg.m/s2&gt;</span>
</pre>
<p>And of course it does conversion:</p>
<pre class="highlight text">mass.pound
=&gt; &lt;Unitwise::Measurement 189.5975454789947 pound&gt;

force.newton
=&gt; &lt;Unitwise::Measurement 140.4666666666667 newton&gt;
</pre>
<p>Obviously, this is a very simple example, but the possibilities are certainly endless. UCUM (and by extension Unitwise) features 95 metric units, 199 non-metric units, and 24 unit prefixes. That&#39;s approximately 2,500 basic units to start you with, but these can be combined with multiplication and division for infinite combinations.</p>

<p>You can find Unitwise at <a href="https://github.com/joshwlewis/unitwise">github.com/joshwlewis/unitwise</a>. Check out the README there for installation and additional usage instructions.</p>

</div>
</div>
<div class='row footer'>
<div class='span8 offset2 well'>
This article was categorized as
<a href="/essays/categories/ruby">ruby</a>, <a href="/essays/categories/gem">gem</a>, <a href="/essays/categories/math">math</a>, and <a href="/essays/categories/science">science</a>
</div>
</div>
</div>
</section>
<footer class='explore center'>
<div class='row'>
<div class='span8 offset2'>
<h3><a href="/essays">Explore the Blog</a></h3>
<div class='row'>
<div class='span4 articles'>
<h4>Essays</h4>
<p><a href="/essays/unitwise-ruby-unit-measurement">Unitwise: Ruby Unit Measurement Math and Conversion</a></p>
<p><a href="/essays/rails-active-support-try">Rails' ActiveSupport try</a></p>
<p><a href="/essays/rails_flash_messages_with_twitter_bootstrap">Rails Flash Messages with Twitter Bootstrap</a></p>
<p><a href="/essays/static_site_creation_with_middleman">Static Site Creation with Middleman</a></p>
</div>
<div class='span4 categories'>
<h4>Categories</h4>
<p><a href="/essays/categories/ruby">ruby</a></p>
<p><a href="/essays/categories/html">html</a></p>
<p><a href="/essays/categories/middleman">middleman</a></p>
<p><a href="/essays/categories/rails">rails</a></p>
</div>
</div>
</div>
</div>
</footer>
</div>
</div>
<footer class='copyright'>
Copyright &copy
2013
Josh W Lewis
(<a href="http://www.twitter.com/joshwlewis">@joshwlewis</a>)
<a href='//feeds.feedburner.com/JoshWLewis'>
<i class='icon-rss'></i>
</a>
</footer>
<script src="../../javascripts/essays/shapes_grid-f7559597.js" type="text/javascript"></script>
<script>
  var _gaq=[['_setAccount','UA-38264259-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var shape_canvas = $('#fixed_banner canvas')[0];
  shape_canvas.height = 192;
  shape_canvas.width = 576;
  context = shape_canvas.getContext('2d');
  context.scale(2,2)
  var grid = new shapes_grid(context, 40, 6, 2);
  grid.shape_colors = ["#672435","#4E4E4E", "#7F7F7E", "#1B344D", "#295580"];
  grid.font = "Droid Sans Mono"
  grid.side_counts = [[1,4,6].sample()];
  grid.letters.push({letter: 'j', c: 1, r: 1});
  grid.letters.push({letter: 'o', c: 2, r: 1});
  grid.letters.push({letter: 's', c: 3, r: 1});
  grid.letters.push({letter: 'h', c: 4, r: 1});
  grid.letters.push({letter: 'w', c: 6, r: 1});
  grid.letters.push({letter: 'l', c: 2, r: 2});
  grid.letters.push({letter: 'e', c: 3, r: 2});
  grid.letters.push({letter: 'w', c: 4, r: 2});
  grid.letters.push({letter: 'i', c: 5, r: 2});
  grid.letters.push({letter: 's', c: 6, r: 2});
  grid.init();
  animations.push(grid);
  animate();
</script>
</body>
</html>

